<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="SortTestHelper.js"></script>
</head>
<body>
<script>
    let maxHeap = {
        data: [],
        initArr: function (arr) {
            Array.prototype.push.apply(this.data, arr)
            this.data.splice(0, 0, '');
        },
        shiftUp: function (el) {
            if (!el) {
                return
            }
            this.data.push(el)
            let count = this.data.length - 1;
            while (count > 1 && this.data[count] > this.data[Math.floor(count / 2)]) {
                wrap(this.data, count, Math.floor(count / 2));
                count = Math.floor(count / 2);
            }
        },
        shiftDown: function (k) {
            let count = this.data.length;
            wrap(this.data, 1, count - 1);
            this.data.length--;
            while (2 * k < this.data.length && this.data[k] < this.data[2 * k]) {
                let j = 2 * k;
                if (j + 1 <= count - 1 && this.data[j + 1] > this.data[j]) {
                    j += 1;
                }
                wrap(this.data, k, j);
                k = j;
            }
            console.log(this.data)
        },
        heaPiFyShiftDown: function (k) {
            let count = this.data.length;
            wrap(this.data, 1, count - 1);
            while (2 * k < this.data.length && this.data[k] < this.data[2 * k]) {
                let j = 2 * k;
                if (j + 1 <= count - 1 && this.data[j + 1] > this.data[j]) {
                    j += 1;
                }
                wrap(this.data, k, j);
                k = j;
            }
        },
        heaPiFy: function (arr) {
            this.data.push('');
            for (let i = 0; i < arr.length; i++) {
                this.shiftUp(arr[i])
            }
            this.data = [''].concat(this.data.slice(1).reverse())
            let n = this.data.length;
            for (let i = Math.ceil(n / 2); i >= 1; i--) {
                console.log(i);
                this.heaPiFyShiftDown(i)
            }
            console.log(this.data)
        },
        heapSort: function (arr) {
            let len = arr.length;
            Array.prototype.push.apply(this.data, arr)
//
//            for (let i = Math.floor((len - 1) / 2); i >= 0; i--) {
//                this._shiftDown(len, i)
//            }
//            console.log(this.data)
            for (let i = len - 1; i > 0; i--) {
                wrap(this.data, 0, i)
                console.log(this.data)
                this._shiftDown(i, 0)
            }
        },
        _shiftDown(n, k) {
            while (2 * k + 1 < n) {
                let j = 2 * k + 1;  //在此轮循环中，arr[k]和arr[j]交换位置
                if (j + 1 < n && this.data[j + 1] > this.data[j]) {
                    j += 1;
                }
                if(this.data[k] > this.data[j]){
                    break
                }
                wrap(this.data, k, j);
                k = j;
                console.log(this.data)
            }
        }
    }
    //    maxHeap.initArr([10,9,8,7,6,5,3,2,1,1]);
    //    maxHeap.shiftDown(1);
    maxHeap.heapSort([9,8,7,6,5,4,3,2,1,0])
</script>
</body>
</html>