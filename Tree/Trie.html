<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Trie</title>
</head>
<body>
<script>
    class TrieNode {
        constructor() {
            this.next = new Map();
            this.isWord = false;
        }
    }

    class Trie {
        constructor() {
            this.root = new TrieNode(null);
            this.size = 0;
        }

        add(word) {
            let cur = this.root,
                c;
            for (let i = 0; i < word.length; i++) {
                c = word.charAt(i);
                if (!cur.next.get(c)) {
                    cur.next.set(c, new TrieNode(c))
                }
                cur = cur.next.get(c);
            }
            if (!cur.isWord) {
                cur.isWord = true;
                this.size++
            }
        }

        search(word) {
            let cur = this.root;
            return this.match(cur, word, 0)
        }

        match(node, word, index) {
            if (index === word.length) return node.isWord;

            let c = word.charAt(index);
            if (c === '.') {
                for (let key of node.next.keys()) {
                    if (this.match(node.next.get(key), word, index + 1)) return true
                }
                return false
            } else {
                if (!node.next.has(c)) return false;
                return this.match(node.next.get(c), word, index + 1)
            }
        }

        isPrefix(prefix) {
            let cur = this.root,
                c;
            for (let i = 0; i < prefix.length; i++) {
                c = prefix.charAt(i);
                if (!cur.next.has(c)) {
                    return false
                }
                cur = cur.next.get(c);
            }
            return true
        }

        getSize() {
            return this.size;
        }
    }

    let trie = new Trie();
    trie.add('apple')
    trie.add('panda')
    // trie.add('pan')
    console.log(trie.isPrefix('pa'))
    console.log(trie.search('p...a'))
</script>
</body>
</html>