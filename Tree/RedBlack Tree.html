<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    const RED = true;
    const BLACK = false;

    class Node {
        constructor(key, value) {
            this.key = key;
            this.value = value;
            this.left = null;
            this.right = null;
            this.color = RED;
        }
    }

    class RedBlackTree {
        constructor() {
            this.root = null;
            this.size = 0;
        }

        add(key, value) {
            this.root = this._add(this.root, key, value);
            this.root.color = BLACK
        }

        _add(node, key, value) {
            if (!node) return new Node(key, value);

            if (key < node.key) {
                node.left = this._add(node.left, key, value)
            } else if (key > node.key) {
                node.right = this._add(node.right, key, value)
            } else {
                node.value = value
            }

            return node
        }

        //   node                     x
        //  /   \     左旋转         /  \
        // T1   x   --------->   node   T3
        //     / \              /   \
        //    T2 T3            T1   T2
        leftRotate(node) {
            let x = node.right,
                T2 = x.right;

            x.left = node;
            node.right = T2;

            x.color = node.color;
            node.color = RED

            return x
        }

        //     node                   x
        //    /   \     右旋转       /  \
        //   x    T2   ------->   y   node
        //  / \                       /  \
        // y  T1                     T1  T2
        rightRotate(node) {
            let x = node.left,
                T1 = x.right;
            x.right = node;
            node.left = T1;

            x.color = node.color;
            node.color = RED;

            return x
        }

        flipColors(node) {
            node.color = RED;
            node.left.color = BLACK;
            node.right.color = BLACK
        }

        getSize() {
            return this.size
        }

        isEmpty() {
            return this.size === 0
        }

        isRed(node) {
            if (!node) return BLACK;

            return node.color
        }
    }
</script>
</body>
</html>